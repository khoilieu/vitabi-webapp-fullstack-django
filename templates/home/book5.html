{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <link rel="icon" href="{% static "home/favicon.png" %}" type="image/x-icon">
    <title>Book5</title>
    <link rel="stylesheet" href="{% static "home/book5.css" %}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NBX832CK');</script>
    <!-- End Google Tag Manager -->

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "nqixhxf3g6");
    </script>
</head>
<style>
    body {
        font-family: Arial, sans-serif; /* フォントを一般的なものに変更 */
        {% comment %} background-color: #f8f9fa; /* 背景色を明るいグレーに変更 */ {% endcomment %}
        margin: 0;
        padding: 20px; /* パディングを追加 */
    }

    #loading-overlay {
        display: none;
        justify-content: center;
        align-items: center;
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        z-index: 9999;
        background-color: rgba(255, 255, 255, 0.8);
    }
    
    .spinner-container {
        text-align: center;
    }
    
    .hospital-item {
        background-color: white; /* 各項目の背景色を白に */
        border-radius: 8px; /* 角を丸くする */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* シャドウを追加 */
        margin-bottom: 20px; /* 各項目の間隔を調整 */
        padding: 15px; /* パディングを追加 */
    }
    
    .header-info h4 {
        margin: 0; /* マージンをリセット */
        font-size: 1.25rem; /* フォントサイズを調整 */
        color: #333; /* テキストの色をダークグレーに変更 */
    }
    
    .header-info a {
        color: #007bff; /* アイコンの色を青に変更 */
        text-decoration: none; /* 下線を削除 */
    }
    
    .header-info a:hover {
        color: #0056b3; /* ホバー時の色を変更 */
    }
    
    .hospital-info {
        overflow: hidden;
    }
    
    .hospital-info p {
        margin: 5px 0; /* 各段落のマージンを調整 */
        color: #555; /* テキストの色をグレーに変更 */
    }
    
    #symptom {
        white-space: normal;
        word-wrap: break-word;
    }
    
    .footer {
        text-align: center; /* フッターを中央揃え */
        margin-top: 20px; /* 上部のマージンを追加 */
    }
    
    input[type="submit"] {
        background-color: #007bff; /* ボタンの背景色を青に */
        color: white; /* ボタンの文字色を白に */
        border: none; /* ボーダーを削除 */
        border-radius: 5px; /* 角を丸くする */
        padding: 10px 20px; /* パディングを追加 */
        cursor: pointer; /* カーソルをポインターに */
        font-size: 1rem; /* フォントサイズを調整 */
    }
    
    input[type="submit"]:hover {
        background-color: #0056b3; /* ホバー時の色を変更 */
    }
</style>
  <body>
    <div id="loading-overlay">
        <div class="spinner-container">
            <span class="spinner-border spinner-border-md" aria-hidden="true"></span>
            <br>
            <span role="status" class="fw-bold">{% trans "Loading..." %}</span>
            <br>
            <span role="status" class="fw-bold">{% trans "It may take 10 seconds" %}</span>
        </div>
    </div>
      
    <section>
        <header>
            <a href="{% url "book4" %}"><img src="{% static "home/arrow-left.svg" %}" alt="Back-arrow" style="width: 22px; height: 22px;"></a>
            <div class="top">
                <h1 class="fs-5">{% trans "Final Confirmation" %}</h1>      
            </div>
            <a class="stop-arrow" href="{% url "hospitalInfo" hospital_id %}"><button type="button" class="btn-close" aria-label="Close"></button></a>
        </header>

        <main>
            <form class="form" method="POST" action="">
                {% csrf_token %}
                <div class="hospital-item">
                    <div class="hospital-info">
                        <div class="header-info">
                            <h4>{% trans "Personal Information" %} (1/3)</h4>
                            <a href="{% url "book1" hospital.id %}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                                </svg>
                            </a>
                        </div>
                        <hr>
                        <p><strong>{% trans "Name" %}:</strong> {{ firstname }} {{ surname }}</p>
                        <p><strong>{% trans "Gender" %}:</strong> {% if gender %}{% trans "Male" %}{% else %}{% trans "Female" %}{% endif %}</p>
                        <p><strong>{% trans "Date of Birth" %}:</strong> {{ dob }}</p>
                        <p><strong>{% trans "Email Address" %}:</strong> {{ email }}</p>
                        <p><strong>{% trans "Phone Number" %}:</strong> {{phone_country_code}}{{ phone }}</p>
                    </div>
                </div>
                <div class="hospital-item">
                    <div class="hospital-info">
                        <div class="header-info">
                            <h4>{% trans "Appointment Information" %} (2/3)</h4>
                            <a href="{% url "book3" %}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                                </svg>
                            </a>
                        </div>
                        <hr>
                        <p><strong>{% trans "Selected Hospital" %}:</strong> {{ hospital.name }}</p>
                        <p><strong>{% trans "1st Preferred Date/Times" %}:</strong> {{ firstdate }}: {{ firstdatefrom }}~{{ firstdateto }}</p>
                        {% if seconddate or seconddatefrom or seconddateto %}
                        <p><strong>{% trans "2nd Preferred Date/Times" %}:</strong>
                            {% if seconddate %}
                                {{ seconddate }}
                            {% endif %} 
                            {% if seconddatefrom and seconddateto %}
                                {% trans "from" %} {{ seconddatefrom }} {% trans "to" %} {{ seconddateto }}
                            {% elif seconddatefrom %}
                                {{ seconddatefrom }}
                            {% elif seconddateto %}
                                {{ seconddateto }}
                            {% endif %}
                        </p>
                        {% endif %}
                        <p><strong>{% trans "Symptom" %}:</strong>
                            {% if symptom|length > 112 %}
                                {{ symptom|slice:":112" }}<a href="#" id="showMoreLink" onclick="showMoreInfo()" style="display: inline;">[{{ "Show More" }}]</a>
                                <span id="symptom" style="display: none;">
                                    {{ symptom|slice:"112:" }}
                                    <a href="#" id="showLessLink" onclick="showLessInfo()" style="display: none;">[{{ "Show Less" }}]</a>
                                </span>
                            {% else %}
                                <span>{{ symptom }}</span>
                            {% endif %}
                        </p>
                        <p><strong>{% trans "Duration" %}:</strong> {{ duration }} </p>
                    </div>
                </div>
                <div class="hospital-item" style="margin-bottom: 50px;">
                    <div class="hospital-info">
                        <div class="header-info">
                            <h4>{% trans "Insurance Information" %} (3/3)</h4>
                            <a href="{% url "book4" %}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                                </svg>
                            </a>
                        </div>
                        <hr>
                        <p><strong>{% trans "Insurance" %}:</strong> {{ coverage }} {% if insuranceCompany %} - {{ insuranceCompany }}{% endif %}</p>
                        <p><strong>{% trans "Policy Number" %}:</strong> {% if policyNumber %} {{ policyNumber }} {% else %} {% trans "You don't select any insurance" %} {% endif %}</p>
                    </div>
                </div>
            
        </main>

        <div class="footer">
            <input type="submit" id="book5" value={% trans "Confirm and Book"%} style="cursor: pointer;"/>
        </div>
        </form>
    </section>
  </body>
  {% if user.is_authenticated and user.patient.is_patient %}
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NBX832CK"
		height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->	
	{% endif %}	
</html>
<script>
    function showLoading() {
        document.getElementById("loading-overlay").style.display = "flex";
    }
    
    function hideLoading() {
        document.getElementById("loading-overlay").style.display = "none";
    }
    
    function showMoreInfo() {
        var moreInfo = document.getElementById("symptom");
        var showMoreLink = document.getElementById("showMoreLink");
        var showLessLink = document.getElementById("showLessLink");
    
        if (moreInfo && showMoreLink && showLessLink) {
            moreInfo.style.display = "inline";
            showMoreLink.style.display = "none";
            showLessLink.style.display = "inline";
        }
    }
    
    function showLessInfo() {
        var moreInfo = document.getElementById("symptom");
        var showMoreLink = document.getElementById("showMoreLink");
        var showLessLink = document.getElementById("showLessLink");
    
        if (moreInfo && showMoreLink && showLessLink) {
            moreInfo.style.display = "none";
            showMoreLink.style.display = "inline";
            showLessLink.style.display = "none";
        }
    }  

    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.stop-arrow').forEach(function(link) {
          link.addEventListener('click', function (e) {
            e.preventDefault(); 
            var confirmation = confirm('Are you sure you want to cancel?');
    
            if (confirmation) {
              var href = this.getAttribute('href'); 
              window.location.href = href; 
            }
          });
        });

        document.getElementById('book5').addEventListener('click', function() {
            showLoading();
        });
    });
</script>

